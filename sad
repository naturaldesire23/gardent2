--// Key system
local Players = game:GetService("Players")
local plr = Players.LocalPlayer
local TweenService = game:GetService("TweenService")

print("Waiting for key...")

--// Status Display (Top of screen)
local StatusGui = Instance.new("ScreenGui")
StatusGui.Name = "StatusDisplay"
StatusGui.Parent = plr.PlayerGui
StatusGui.ResetOnSpawn = false

local StatusFrame = Instance.new("Frame")
StatusFrame.Size = UDim2.new(0, 200, 0, 30)
StatusFrame.Position = UDim2.new(0.5, -100, 0, 10) -- Top center
StatusFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
StatusFrame.BackgroundTransparency = 0.3
StatusFrame.BorderSizePixel = 0
StatusFrame.Parent = StatusGui

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 5)
StatusCorner.Parent = StatusFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, 0, 1, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Status: Loading..."
StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 0) -- Green text
StatusLabel.Font = Enum.Font.GothamBold
StatusLabel.TextSize = 14
StatusLabel.Parent = StatusFrame

--// Pastebin Whitelist Check
local function checkPastebinWhitelist(username)
    StatusLabel.Text = "Status: Checking Whitelist..."
    
    -- YOUR PASTEBIN RAW URL (get this from the RAW button)
    local pastebinUrl = "https://pastebin.com/raw/JQvrr7af"  -- ← REPLACE WITH RAW URL
    
    local success, response = pcall(function()
        return game:HttpGet(pastebinUrl)
    end)
    
    if success then
        -- Check if username is in the whitelist
        for line in response:gmatch("[^\r\n]+") do
            if line:lower() == username:lower() then
                StatusLabel.Text = "Status: Whitelist Verified"
                return true
            end
        end
    else
        warn("Pastebin check failed: " .. tostring(response))
    end
    
    StatusLabel.Text = "Status: Not Whitelisted"
    return false
end

--// Beautiful Key GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "KeySystemGUI"
ScreenGui.Parent = plr:WaitForChild("PlayerGui")

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 350, 0, 280)
Frame.Position = UDim2.new(0.5, -175, 0.5, -140)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
Frame.BorderSizePixel = 0
Frame.BackgroundTransparency = 0.1
Frame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = Frame

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(80, 80, 120)
UIStroke.Thickness = 2
UIStroke.Parent = Frame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 60)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "KEY SYSTEM"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 24
Title.TextStrokeTransparency = 0.8
Title.Parent = Frame

local SubTitle = Instance.new("TextLabel")
SubTitle.Size = UDim2.new(1, -40, 0, 30)
SubTitle.Position = UDim2.new(0, 20, 0, 45)
SubTitle.BackgroundTransparency = 1
SubTitle.Text = "Enter the key to continue"
SubTitle.TextColor3 = Color3.fromRGB(200, 200, 220)
SubTitle.Font = Enum.Font.Gotham
SubTitle.TextSize = 14
SubTitle.Parent = Frame

local TextBoxContainer = Instance.new("Frame")
TextBoxContainer.Size = UDim2.new(1, -40, 0, 50)
TextBoxContainer.Position = UDim2.new(0, 20, 0, 85)
TextBoxContainer.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
TextBoxContainer.BorderSizePixel = 0
TextBoxContainer.Parent = Frame

local TextBoxCorner = Instance.new("UICorner")
TextBoxCorner.CornerRadius = UDim.new(0, 8)
TextBoxCorner.Parent = TextBoxContainer

local TextBox = Instance.new("TextBox")
TextBox.Size = UDim2.new(1, -20, 1, -10)
TextBox.Position = UDim2.new(0, 10, 0, 5)
TextBox.PlaceholderText = "Enter key here..."
TextBox.Text = ""
TextBox.Font = Enum.Font.Gotham
TextBox.TextSize = 16
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBox.BackgroundTransparency = 1
TextBox.PlaceholderColor3 = Color3.fromRGB(150, 150, 170)
TextBox.Parent = TextBoxContainer

local CheckBtn = Instance.new("TextButton")
CheckBtn.Size = UDim2.new(1, -40, 0, 50)
CheckBtn.Position = UDim2.new(0, 20, 0, 150)
CheckBtn.Text = "VERIFY KEY"
CheckBtn.Font = Enum.Font.GothamBold
CheckBtn.TextSize = 18
CheckBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CheckBtn.BackgroundColor3 = Color3.fromRGB(80, 120, 220)
CheckBtn.BorderSizePixel = 0
CheckBtn.AutoButtonColor = true
CheckBtn.Parent = Frame

local CheckBtnCorner = Instance.new("UICorner")
CheckBtnCorner.CornerRadius = UDim.new(0, 8)
CheckBtnCorner.Parent = CheckBtn

local Label = Instance.new("TextLabel")
Label.Size = UDim2.new(1, -40, 0, 40)
Label.Position = UDim2.new(0, 20, 0, 210)
Label.BackgroundTransparency = 1
Label.Text = ""
Label.Font = Enum.Font.GothamBold
Label.TextSize = 14
Label.TextColor3 = Color3.fromRGB(255, 255, 255)
Label.TextWrapped = true
Label.Parent = Frame

print("GUI created successfully!")

-- Hover effects
CheckBtn.MouseEnter:Connect(function()
    TweenService:Create(CheckBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 140, 240)}):Play()
end)

CheckBtn.MouseLeave:Connect(function()
    TweenService:Create(CheckBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 120, 220)}):Play()
end)

-- Animation on load
Frame.BackgroundTransparency = 1
Frame.Position = UDim2.new(0.5, -175, 0.4, -140)
TweenService:Create(Frame, TweenInfo.new(0.5), {BackgroundTransparency = 0.1, Position = UDim2.new(0.5, -175, 0.5, -140)}):Play()

--// Seeds and Playtime Display (Right side)
local function createSeedsDisplay()
    local SeedsGui = Instance.new("ScreenGui")
    SeedsGui.Name = "SeedsDisplay"
    SeedsGui.Parent = plr.PlayerGui
    SeedsGui.ResetOnSpawn = false
    
    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 200, 0, 80)
    MainFrame.Position = UDim2.new(1, -220, 0, 20) -- Top right corner
    MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    MainFrame.BackgroundTransparency = 0.3
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = SeedsGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = MainFrame
    
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = Color3.fromRGB(255, 0, 0)
    UIStroke.Thickness = 2
    UIStroke.Parent = MainFrame
    
    -- Seeds Title
    local SeedsTitle = Instance.new("TextLabel")
    SeedsTitle.Size = UDim2.new(1, -10, 0, 20)
    SeedsTitle.Position = UDim2.new(0, 5, 0, 5)
    SeedsTitle.BackgroundTransparency = 1
    SeedsTitle.Text = "SEEDS:"
    SeedsTitle.TextColor3 = Color3.fromRGB(255, 0, 0)
    SeedsTitle.Font = Enum.Font.GothamBold
    SeedsTitle.TextSize = 14
    SeedsTitle.TextXAlignment = Enum.TextXAlignment.Left
    SeedsTitle.Parent = MainFrame
    
    -- Seeds Amount
    local SeedsAmount = Instance.new("TextLabel")
    SeedsAmount.Size = UDim2.new(1, -10, 0, 25)
    SeedsAmount.Position = UDim2.new(0, 5, 0, 25)
    SeedsAmount.BackgroundTransparency = 1
    SeedsAmount.Text = "Loading..."
    SeedsAmount.TextColor3 = Color3.fromRGB(255, 255, 255)
    SeedsAmount.Font = Enum.Font.GothamBold
    SeedsAmount.TextSize = 18
    SeedsAmount.TextXAlignment = Enum.TextXAlignment.Left
    SeedsAmount.Parent = MainFrame
    
    -- Playtime Title
    local TimeTitle = Instance.new("TextLabel")
    TimeTitle.Size = UDim2.new(1, -10, 0, 20)
    TimeTitle.Position = UDim2.new(0, 5, 0, 50)
    TimeTitle.BackgroundTransparency = 1
    TimeTitle.Text = "PLAYTIME:"
    TimeTitle.TextColor3 = Color3.fromRGB(255, 0, 0)
    TimeTitle.Font = Enum.Font.GothamBold
    TimeTitle.TextSize = 14
    TimeTitle.TextXAlignment = Enum.TextXAlignment.Left
    TimeTitle.Parent = MainFrame
    
    -- Playtime Value
    local Playtime = Instance.new("TextLabel")
    Playtime.Size = UDim2.new(1, -10, 0, 25)
    Playtime.Position = UDim2.new(0, 5, 0, 70)
    Playtime.BackgroundTransparency = 1
    Playtime.Text = "0h 0m"
    Playtime.TextColor3 = Color3.fromRGB(255, 255, 255)
    Playtime.Font = Enum.Font.GothamBold
    Playtime.TextSize = 16
    Playtime.TextXAlignment = Enum.TextXAlignment.Left
    Playtime.Parent = MainFrame
    
    return SeedsAmount, Playtime, SeedsGui
end

-- Function to get seeds amount from the game
local function getSeedsAmount()
    local seeds = 0
    
    -- Method 1: Check player stats
    pcall(function()
        if plr:FindFirstChild("leaderstats") then
            local leaderstats = plr.leaderstats
            if leaderstats:FindFirstChild("Seeds") then
                seeds = leaderstats.Seeds.Value
            elseif leaderstats:FindFirstChild("seeds") then
                seeds = leaderstats.seeds.Value
            elseif leaderstats:FindFirstChild("Seed") then
                seeds = leaderstats.Seed.Value
            end
        end
    end)
    
    -- Method 2: Check player data
    pcall(function()
        if plr:FindFirstChild("Data") then
            local data = plr.Data
            if data:FindFirstChild("Seeds") then
                seeds = data.Seeds.Value
            elseif data:FindFirstChild("seeds") then
                seeds = data.seeds.Value
            end
        end
    end)
    
    return seeds
end

-- Initialize the display
local SeedsAmountLabel, PlaytimeLabel, SeedsGui = createSeedsDisplay()
local startTime = os.time()

-- Function to update the display
local function updateDisplay()
    while true do
        -- Update seeds amount
        local currentSeeds = getSeedsAmount()
        SeedsAmountLabel.Text = tostring(currentSeeds)
        
        -- Update playtime
        local currentTime = os.time()
        local elapsedSeconds = currentTime - startTime
        local hours = math.floor(elapsedSeconds / 3600)
        local minutes = math.floor((elapsedSeconds % 3600) / 60)
        
        if hours > 0 then
            PlaytimeLabel.Text = string.format("%dh %dm", hours, minutes)
        else
            PlaytimeLabel.Text = string.format("%dm", minutes)
        end
        
        wait(1)
    end
end

-- Start updating the display
spawn(updateDisplay)

--// Remotes
local rs = game:GetService("ReplicatedStorage")
local remotes = rs:WaitForChild("RemoteFunctions")

-- Auto Skip (enable once at start)
task.delay(2, function()
    pcall(function()
        remotes.ToggleAutoSkip:InvokeServer(true)
        warn("[System] Auto Skip Enabled")
        StatusLabel.Text = "Status: Auto Skip Enabled"
    end)
end)

--=== GAME SCRIPTS ===--
function load2xScript()
    StatusLabel.Text = "Status: Working (2x Speed)"
    warn("[System] Loaded 2x Speed Script")
    remotes.ChangeTickSpeed:InvokeServer(2)
    local difficulty = "dif_impossible"
    local placements = {
        { time = 29, unit = "unit_lawnmower", slot = "1", data = {Valid=true,PathIndex=3,Position=Vector3.new(-843.87384,62.1803055,-123.052032), DistanceAlongPath=248.0065, CF=CFrame.new(-843.87384,62.1803055,-123.052032,-0,0,1,0,1,-0,-1,0,-0), Rotation=180} },
        { time = 47, unit = "unit_rafflesia", slot = "2", data = {Valid=true,PathIndex=3,Position=Vector3.new(-842.381287,62.1803055,-162.012131), DistanceAlongPath=180.53, CF=CFrame.new(-842.381287,62.1803055,-162.012131,1,0,0,0,1,0,0,0,1), Rotation=180} },
        { time = 85, unit = "unit_rafflesia", slot = "2", data = {Valid=true,PathIndex=3,Position=Vector3.new(-842.381287,62.1803055,-164.507538), DistanceAlongPath=178.04, CF=CFrame.new(-842.381287,62.1803055,-164.507538,1,0,0,0,1,0,0,0,1), Rotation=180} },
        { time = 110, unit = "unit_rafflesia", slot = "2", data = {Valid=true,PathIndex=2,Position=Vector3.new(-864.724426,62.1803055,-199.052032), DistanceAlongPath=100.65, CF=CFrame.new(-864.724426,62.1803055,-199.052032,-0,0,1,0,1,0,-1,0,0), Rotation=180} }
    }
    
    local function placeUnit(unitName, slot, data)
        remotes.PlaceUnit:InvokeServer(unitName, data)
        warn("[Placing] "..unitName.." at "..os.clock())
    end
    
    local function startGame()
        remotes.PlaceDifficultyVote:InvokeServer(difficulty)
        for _, p in ipairs(placements) do
            task.delay(p.time, function()
                placeUnit(p.unit, p.slot, p.data)
            end)
        end
    end
    
    while true do
        startGame()
        task.wait(174.5)
        remotes.RestartGame:InvokeServer()
    end
end

function load3xScript()
    StatusLabel.Text = "Status: Working (3x Speed)"
    warn("[System] Loaded 3x Speed Script")
    remotes.ChangeTickSpeed:InvokeServer(3)
    local difficulty = "dif_impossible"
    local placements = {
        { time = 23, unit = "unit_lawnmower", slot = "1", data = {Valid=true,PathIndex=3,Position=Vector3.new(-843.87384,62.1803055,-123.052032), DistanceAlongPath=248.0065, CF=CFrame.new(-843.87384,62.1803055,-123.052032,-0,0,1,0,1,-0,-1,0,-0), Rotation=180} },
        { time = 32, unit = "unit_rafflesia", slot = "2", data = {Valid=true,PathIndex=3,Position=Vector3.new(-842.381287,62.1803055,-162.012131), DistanceAlongPath=180.53, CF=CFrame.new(-842.381287,62.1803055,-162.012131,1,0,0,0,1,0,0,0,1), Rotation=180} },
        { time = 57, unit = "unit_rafflesia", slot = "2", data = {Valid=true,PathIndex=3,Position=Vector3.new(-842.381287,62.1803055,-164.507538), DistanceAlongPath=178.04, CF=CFrame.new(-842.381287,62.1803055,-164.507538,1,0,0,0,1,0,0,0,1), Rotation=180} },
        { time = 77, unit = "unit_rafflesia", slot = "2", data = {Valid=true,PathIndex=2,Position=Vector3.new(-864.724426,62.1803055,-199.052032), DistanceAlongPath=100.65, CF=CFrame.new(-864.724426,62.1803055,-199.052032,-0,0,1,0,1,0,-1,0,0), Rotation=180} }
    }
    
    local function placeUnit(unitName, slot, data)
        remotes.PlaceUnit:InvokeServer(unitName, data)
        warn("[Placing] "..unitName.." at "..os.clock())
    end
    
    local function startGame()
        remotes.PlaceDifficultyVote:InvokeServer(difficulty)
        for _, p in ipairs(placements) do
            task.delay(p.time, function()
                placeUnit(p.unit, p.slot, p.data)
            end)
        end
    end
    
    while true do
        startGame()
        task.wait(128)
        remotes.RestartGame:InvokeServer()
    end
end

--=== SPEED MENU ===--
local function showSpeedMenu()
    StatusLabel.Text = "Status: Key Accepted - Choose Speed"
    Title.Text = "SELECT SPEED"
    SubTitle.Text = "Choose your preferred speed multiplier"
    TextBoxContainer.Visible = false
    CheckBtn.Visible = false
    
    -- Reminder label
    local AutoSkipMsg = Instance.new("TextLabel")
    AutoSkipMsg.Size = UDim2.new(1, -40, 0, 40)
    AutoSkipMsg.Position = UDim2.new(0, 20, 0, 80)
    AutoSkipMsg.BackgroundTransparency = 1
    AutoSkipMsg.Text = "Please enable Auto Skip manually in the game settings"
    AutoSkipMsg.Font = Enum.Font.Gotham
    AutoSkipMsg.TextSize = 12
    AutoSkipMsg.TextColor3 = Color3.fromRGB(255, 200, 100)
    AutoSkipMsg.TextWrapped = true
    AutoSkipMsg.Parent = Frame
    
    local btn2x = Instance.new("TextButton")
    btn2x.Size = UDim2.new(0.45, 0, 0, 50)
    btn2x.Position = UDim2.new(0.05, 0, 0.5, -25)
    btn2x.Text = "2x SPEED"
    btn2x.BackgroundColor3 = Color3.fromRGB(80, 160, 250)
    btn2x.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn2x.Font = Enum.Font.GothamBold
    btn2x.TextSize = 16
    btn2x.BorderSizePixel = 0
    btn2x.AutoButtonColor = true
    btn2x.Parent = Frame
    
    local btn3x = Instance.new("TextButton")
    btn3x.Size = UDim2.new(0.45, 0, 0, 50)
    btn3x.Position = UDim2.new(0.5, 0, 0.5, -25)
    btn3x.Text = "3x SPEED"
    btn3x.BackgroundColor3 = Color3.fromRGB(250, 120, 120)
    btn3x.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn3x.Font = Enum.Font.GothamBold
    btn3x.TextSize = 16
    btn3x.BorderSizePixel = 0
    btn3x.AutoButtonColor = true
    btn3x.Parent = Frame
    
    local btn2xCorner = Instance.new("UICorner")
    btn2xCorner.CornerRadius = UDim.new(0, 8)
    btn2xCorner.Parent = btn2x
    
    local btn3xCorner = Instance.new("UICorner")
    btn3xCorner.CornerRadius = UDim.new(0, 8)
    btn3xCorner.Parent = btn3x
    
    -- Hover effects for speed buttons
    btn2x.MouseEnter:Connect(function()
        TweenService:Create(btn2x, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 180, 255)}):Play()
    end)
    btn2x.MouseLeave:Connect(function()
        TweenService:Create(btn2x, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 160, 250)}):Play()
    end)
    
    btn3x.MouseEnter:Connect(function()
        TweenService:Create(btn3x, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 140, 140)}):Play()
    end)
    btn3x.MouseLeave:Connect(function()
        TweenService:Create(btn3x, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(250, 120, 120)}):Play()
    end)
    
    btn2x.MouseButton1Click:Connect(function()
        TweenService:Create(Frame, TweenInfo.new(0.5), {BackgroundTransparency = 1, Position = UDim2.new(0.5, -175, 0.4, -140)}):Play()
        task.wait(0.5)
        ScreenGui:Destroy()
        load2xScript()
    end)
    
    btn3x.MouseButton1Click:Connect(function()
        TweenService:Create(Frame, TweenInfo.new(0.5), {BackgroundTransparency = 1, Position = UDim2.new(0.5, -175, 0.4, -140)}):Play()
        task.wait(0.5)
        ScreenGui:Destroy()
        load3xScript()
    end)
end

--=== KEY CHECK ===--
CheckBtn.MouseButton1Click:Connect(function()
    local key = TextBox.Text:lower()
    
    -- Method 1: Check Pastebin whitelist FIRST
    if checkPastebinWhitelist(plr.Name) then
        StatusLabel.Text = "Status: Whitelist Verified"
        Label.Text = "✓ Whitelist Verified!"
        Label.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        TweenService:Create(CheckBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(100, 200, 100)}):Play()
        TweenService:Create(Label, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(100, 255, 100)}):Play()
        
        task.delay(1, showSpeedMenu)
        
    -- Method 2: Backup key system
    elseif key == "cracked" then
        StatusLabel.Text = "Status: Key Verified"
        Label.Text = "✓ Key Accepted!"
        Label.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        TweenService:Create(CheckBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(100, 200, 100)}):Play()
        TweenService:Create(Label, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(100, 255, 100)}):Play()
        
        task.delay(1, showSpeedMenu)
    else
        StatusLabel.Text = "Status: Access Denied"
        TextBox.Text = ""
        Label.Text = "✗ Not Whitelisted/Invalid Key!"
        Label.TextColor3 = Color3.fromRGB(255, 100, 100)
        
        TweenService:Create(CheckBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(220, 100, 100)}):Play()
        TweenService:Create(Label, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(255, 100, 100)}):Play()
        
        task.delay(0.5, function()
            TweenService:Create(CheckBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(80, 120, 220)}):Play()
        end)
    end
end)

-- Also check when Enter key is pressed in textbox
TextBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        CheckBtn.MouseButton1Click:Fire()
    end
end)

-- Update status to show script is ready
StatusLabel.Text = "Status: Ready - Enter Key or Be Whitelisted"

print("Script loaded completely! All features active.")
